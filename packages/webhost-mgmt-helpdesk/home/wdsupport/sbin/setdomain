#!/bin/sh

if [[ ! $1 =~ ^[a-zA-Z0-9.-]+$ ]]; then
	echo "Invalid user"
	exit
fi

if [ ! -d "/var/www/vhosts/"$1 ]; then
	echo "Domain not found"
	exit
fi

usergrep="`egrep ^[^:]+:[^:]+:[^:]+:[^:]+:[^:]?:/var/www/vhosts/"$1":[^:]+ /etc/passwd | cut -d : -f 1,3`"

user="`echo "$usergrep" | cut -d : -f 1`"
uid="`echo "$usergrep" | cut -d : -f 2`"

if [ "$uid" = "" ]; then
	echo "User does not exist"
	exit
fi

if [ "$uid" -ge "10000" ]; then
	cd /var/www/vhosts/$1/httpdocs
	/bin/su -s /bin/bash "$user" -
else
	echo "Illegal user"
fi

